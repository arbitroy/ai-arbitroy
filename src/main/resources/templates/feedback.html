<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" 
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}">
<head>
    <title>Customer Feedback</title>
</head>

<div class="bg-white shadow-lg rounded-lg p-8 w-full max-w-7xl flex gap-8" layout:fragment="content">
    <!-- Feedback Form -->
    <div class="w-1/2">
        <h2 class="text-2xl font-semibold mb-6">Customer Feedback</h2>
        
        <!-- Loading indicator -->
        <div id="feedback-loading" class="hidden text-center text-blue-500 mb-4">
            <p>ðŸ¤– AI is analyzing your feedback...</p>
        </div>
        
        <form hx-post="/submit-feedback" 
              hx-target="#feedback-table-container" 
              hx-swap="innerHTML"
              hx-on::before-request="showFeedbackLoading()"
              hx-on::after-request="hideFeedbackLoading(); clearForm()"
              class="space-y-4">
            <div>
                <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Name</label>
                <input type="text" id="name" name="name" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400" required>
            </div>
            <div>
                <label for="product" class="block text-sm font-medium text-gray-700 mb-1">Product</label>
                <select id="product" name="product" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400" required>
                    <option value="">Select a product</option>
                    <option value="Product A">Product A</option>
                    <option value="Product B">Product B</option>
                    <option value="Product C">Product C</option>
                    <option value="Product D">Product D</option>
                </select>
            </div>
            <div>
                <label for="comment" class="block text-sm font-medium text-gray-700 mb-1">Comment</label>
                <textarea id="comment" name="comment" rows="4" 
                         placeholder="Share your experience, suggestions, questions, or concerns..." 
                         class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400" required></textarea>
            </div>
            <button type="submit" class="bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 disabled:bg-blue-300">
                Submit Feedback
            </button>
        </form>
        
        <div class="mt-4 text-sm text-gray-600">
            <p><strong>ðŸ’¡ How it works:</strong></p>
            <p>Our AI will automatically analyze your feedback and categorize it as:</p>
            <ul class="list-disc list-inside mt-2 space-y-1">
                <li><span class="text-green-600 font-medium">Compliment</span> - Positive feedback and praise</li>
                <li><span class="text-red-600 font-medium">Complaint</span> - Issues and problems</li>
                <li><span class="text-blue-600 font-medium">Suggestion</span> - Improvement ideas</li>
                <li><span class="text-purple-600 font-medium">Query</span> - Questions and requests</li>
            </ul>
        </div>
    </div>
    
    <!-- Feedback Table -->
    <div class="w-1/2">
        <h2 class="text-2xl font-semibold mb-6">Feedback Analysis</h2>
        <div id="feedback-table-container">
            <div th:replace="~{fragments/feedback-table :: table}"></div>
        </div>
    </div>
</div>

<!-- Page-specific scripts -->
<th:block layout:fragment="scripts">
    <script>
        function showFeedbackLoading() {
            document.getElementById('feedback-loading').classList.remove('hidden');
        }

        function hideFeedbackLoading() {
            document.getElementById('feedback-loading').classList.add('hidden');
        }

        function clearForm() {
            document.getElementById('name').value = '';
            document.getElementById('product').value = '';
            document.getElementById('comment').value = '';
        }
    </script>
</th:block>

</html>